# Way3 Trading Game - ì„œë²„ ì•„í‚¤í…ì²˜ & ë°ì´í„° êµ¬ì¡° ê°€ì´ë“œ

> í´ë¼ìš°ë“œì™€ì˜ íš¨ìœ¨ì ì¸ í˜‘ì—…ì„ ìœ„í•œ ì™„ì „í•œ í”„ë¡œì íŠ¸ ì°¸ì¡° ë¬¸ì„œ

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
2. [ì•„í‚¤í…ì²˜ & ê¸°ìˆ  ìŠ¤íƒ](#2-ì•„í‚¤í…ì²˜--ê¸°ìˆ -ìŠ¤íƒ)
3. [ì„œë²„ êµ¬ì¡°](#3-ì„œë²„-êµ¬ì¡°)
4. [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#4-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
5. [API ì—”ë“œí¬ì¸íŠ¸](#5-api-ì—”ë“œí¬ì¸íŠ¸)
6. [ê²Œì„ ì‹œìŠ¤í…œ ë¡œì§](#6-ê²Œì„-ì‹œìŠ¤í…œ-ë¡œì§)
7. [ìƒì¸ ìºë¦­í„° ì •ë³´](#7-ìƒì¸-ìºë¦­í„°-ì •ë³´)
8. [ì‹¤ì‹œê°„ í†µì‹ ](#8-ì‹¤ì‹œê°„-í†µì‹ )
9. [ë°°í¬ ë° í™˜ê²½](#9-ë°°í¬-ë°-í™˜ê²½)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### ğŸ® ê²Œì„ ì»¨ì…‰
**Way3 Trading Game**ì€ ìœ„ì¹˜ ê¸°ë°˜ ëª¨ë°”ì¼ ê±°ë˜ ì‹œë®¬ë ˆì´ì…˜ ê²Œì„ì…ë‹ˆë‹¤.

**í•µì‹¬ íŠ¹ì§•:**
- **ìœ„ì¹˜ ê¸°ë°˜ ê±°ë˜**: GPSë¥¼ í™œìš©í•œ ì‹¤ì œ ìœ„ì¹˜ì—ì„œì˜ ìƒì¸ê³¼ì˜ ê±°ë˜
- **8ëª…ì˜ ê°œì„± ìˆëŠ” ìºë¦­í„° ìƒì¸**: ê°ê° ê³ ìœ í•œ ì„±ê²©ê³¼ ê±°ë˜ íŠ¹ì„±
- **ì‹¤ì‹œê°„ í€˜ìŠ¤íŠ¸ ì‹œìŠ¤í…œ**: ì¼ì¼ í€˜ìŠ¤íŠ¸ì™€ ì„±ì·¨ ì‹œìŠ¤í…œ
- **ì†Œì…œ ê±°ë˜**: ì‹¤ì‹œê°„ ì±„íŒ…ê³¼ í”Œë ˆì´ì–´ ê°„ ìƒí˜¸ì‘ìš©

### ğŸ¯ ê²Œì„ ëª©í‘œ
- ë‹¤ì–‘í•œ ì•„ì´í…œì„ ê±°ë˜í•˜ì—¬ ìˆ˜ìµ ì°½ì¶œ
- ìƒì¸ë“¤ê³¼ì˜ ê´€ê³„ êµ¬ì¶• ë° ì‹ ë¢°ë„ í–¥ìƒ
- í€˜ìŠ¤íŠ¸ ì™„ë£Œë¥¼ í†µí•œ ê²½í—˜ì¹˜ ë° ë³´ìƒ íšë“
- ë¼ì´ì„¼ìŠ¤ ì—…ê·¸ë ˆì´ë“œë¡œ ê³ ê¸‰ ì•„ì´í…œ ê±°ë˜ ì ‘ê·¼

---

## 2. ì•„í‚¤í…ì²˜ & ê¸°ìˆ  ìŠ¤íƒ

### ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   iOS Client    â”‚â—„â”€â”€â–ºâ”‚   Node.js       â”‚â—„â”€â”€â–ºâ”‚     SQLite      â”‚
â”‚   (SwiftUI)     â”‚    â”‚   Server        â”‚    â”‚   Database      â”‚
â”‚                 â”‚    â”‚   (Express)     â”‚    â”‚                 â”‚
â”‚ â€¢ CoreLocation  â”‚    â”‚ â€¢ Socket.IO     â”‚    â”‚ â€¢ 8 ìƒì¸ ë°ì´í„°  â”‚
â”‚ â€¢ Socket.IO     â”‚    â”‚ â€¢ JWT Auth      â”‚    â”‚ â€¢ í”Œë ˆì´ì–´ ì •ë³´  â”‚
â”‚ â€¢ GameManager   â”‚    â”‚ â€¢ REST API      â”‚    â”‚ â€¢ ì•„ì´í…œ & í€˜ìŠ¤íŠ¸â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Railway      â”‚
                    â”‚   (Deployment)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ’» í´ë¼ì´ì–¸íŠ¸ ê¸°ìˆ  ìŠ¤íƒ
- **ì–¸ì–´**: Swift
- **UI í”„ë ˆì„ì›Œí¬**: SwiftUI
- **ìœ„ì¹˜ ì„œë¹„ìŠ¤**: CoreLocation
- **ì‹¤ì‹œê°„ í†µì‹ **: Socket.IO Client
- **ë„¤íŠ¸ì›Œí‚¹**: URLSession + Combine
- **ìƒíƒœ ê´€ë¦¬**: ObservableObject + @Published

### ğŸ–¥ï¸ ì„œë²„ ê¸°ìˆ  ìŠ¤íƒ
- **ëŸ°íƒ€ì„**: Node.js 18+
- **ì›¹ í”„ë ˆì„ì›Œí¬**: Express.js
- **ë°ì´í„°ë² ì´ìŠ¤**: SQLite3
- **ì‹¤ì‹œê°„ í†µì‹ **: Socket.IO
- **ì¸ì¦**: JWT + bcrypt
- **ë¡œê¹…**: Winston
- **ë°°í¬**: Railway Platform

### ğŸ”§ ì£¼ìš” íŒ¨í‚¤ì§€ ì˜ì¡´ì„±
```json
{
  "express": "^4.18.2",
  "socket.io": "^4.7.2",
  "sqlite3": "^5.1.6",
  "jsonwebtoken": "^9.0.2",
  "bcrypt": "^5.1.1",
  "winston": "^3.10.0",
  "express-validator": "^7.0.1"
}
```

---

## 3. ì„œë²„ êµ¬ì¡°

### ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
theway_server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ server.js                 # ë©”ì¸ ì„œë²„ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”‚   â”œâ”€â”€ app.js                    # Express ì•± ì„¤ì •
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ logger.js            # ë¡œê¹… ì„¤ì •
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ DatabaseManager.js   # SQLite ì—°ê²° ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ seed.js              # ì´ˆê¸° ë°ì´í„° ìƒì„±
â”‚   â”‚   â”œâ”€â”€ migrate.js           # ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
â”‚   â”‚   â””â”€â”€ migrations/          # SQL ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ë“¤
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ auth.js              # ê¸°ë³¸ ì¸ì¦
â”‚   â”‚   â”œâ”€â”€ jwtAuth.js           # JWT ì¸ì¦
â”‚   â”‚   â”œâ”€â”€ adminAuth.js         # ê´€ë¦¬ì ì¸ì¦
â”‚   â”‚   â””â”€â”€ errorHandler.js      # ì „ì—­ ì—ëŸ¬ ì²˜ë¦¬
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ merchants.js     # ìƒì¸ ê´€ë ¨ API
â”‚   â”‚   â”‚   â”œâ”€â”€ player.js        # í”Œë ˆì´ì–´ ê´€ë ¨ API
â”‚   â”‚   â”‚   â”œâ”€â”€ quests.js        # í€˜ìŠ¤íŠ¸ API
â”‚   â”‚   â”‚   â”œâ”€â”€ trade.js         # ê±°ë˜ API
â”‚   â”‚   â”‚   â””â”€â”€ auth.js          # ì¸ì¦ API
â”‚   â”‚   â””â”€â”€ admin/               # ê´€ë¦¬ì ë¼ìš°íŠ¸ë“¤
â”‚   â”œâ”€â”€ socket/
â”‚   â”‚   â””â”€â”€ handlers/
â”‚   â”‚       â”œâ”€â”€ index.js         # Socket í•¸ë“¤ëŸ¬ ë“±ë¡
â”‚   â”‚       â”œâ”€â”€ chatHandler.js   # ì±„íŒ… ì²˜ë¦¬
â”‚   â”‚       â”œâ”€â”€ tradeHandler.js  # ì‹¤ì‹œê°„ ê±°ë˜
â”‚   â”‚       â””â”€â”€ locationHandler.js # ìœ„ì¹˜ ì—…ë°ì´íŠ¸
â”‚   â”œâ”€â”€ services/                # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì„œë¹„ìŠ¤ë“¤
â”‚   â”œâ”€â”€ controllers/             # ì»¨íŠ¸ë¡¤ëŸ¬ë“¤
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ MetricsCollector.js  # ë©”íŠ¸ë¦­ ìˆ˜ì§‘
â”‚       â””â”€â”€ StandardResponse.js  # í‘œì¤€ ì‘ë‹µ í˜•ì‹
â”œâ”€â”€ public/                      # ì •ì  íŒŒì¼ë“¤
â”œâ”€â”€ claudedocs/                  # í”„ë¡œì íŠ¸ ë¬¸ì„œë“¤
â””â”€â”€ package.json
```

### âš¡ í•µì‹¬ ì»´í¬ë„ŒíŠ¸

#### **server.js - ë©”ì¸ ì„œë²„**
- HTTP ì„œë²„ ë° Socket.IO ì„œë²„ ì„¤ì •
- CORS ì •ì±… (ëª¨ë°”ì¼ ì•± ë° ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ ì§€ì›)
- ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
- ìš°ì•„í•œ ì¢…ë£Œ ì²˜ë¦¬

#### **DatabaseManager.js - ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬**
- SQLite ì—°ê²° ê´€ë¦¬
- í…Œì´ë¸” ìƒì„± ë° ìŠ¤í‚¤ë§ˆ ê´€ë¦¬
- ì¿¼ë¦¬ ì‹¤í–‰ ë©”ì„œë“œ (`get`, `all`, `run`)
- íŠ¸ëœì­ì…˜ ì§€ì›

#### **ë¯¸ë“¤ì›¨ì–´ ì‹œìŠ¤í…œ**
- **auth.js**: ê¸°ë³¸ ì‚¬ìš©ì ì¸ì¦
- **jwtAuth.js**: JWT í† í° ê¸°ë°˜ ì¸ì¦
- **errorHandler.js**: ì „ì—­ ì—ëŸ¬ ì²˜ë¦¬ ë° ì‘ë‹µ

---

## 4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### ğŸ—„ï¸ í•µì‹¬ í…Œì´ë¸” êµ¬ì¡°

#### **users** - ì‚¬ìš©ì ê³„ì •
```sql
CREATE TABLE users (
    id TEXT PRIMARY KEY,
    email TEXT UNIQUE NOT NULL,
    password_hash TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_active BOOLEAN DEFAULT TRUE
);
```

#### **players** - í”Œë ˆì´ì–´ ê²Œì„ ë°ì´í„°
```sql
CREATE TABLE players (
    id TEXT PRIMARY KEY,
    user_id TEXT NOT NULL,
    name TEXT NOT NULL,
    money INTEGER DEFAULT 50000,           -- ê²Œì„ ë¨¸ë‹ˆ
    trust_points INTEGER DEFAULT 0,       -- ì‹ ë¢° í¬ì¸íŠ¸
    reputation INTEGER DEFAULT 0,         -- í‰íŒ
    current_license INTEGER DEFAULT 0,    -- í˜„ì¬ ë¼ì´ì„¼ìŠ¤ ë ˆë²¨
    max_inventory_size INTEGER DEFAULT 5, -- ì¸ë²¤í† ë¦¬ ìµœëŒ€ í¬ê¸°
    level INTEGER DEFAULT 1,              -- í”Œë ˆì´ì–´ ë ˆë²¨
    experience INTEGER DEFAULT 0,         -- ê²½í—˜ì¹˜

    -- ìŠ¤íƒ¯
    strength INTEGER DEFAULT 10,          -- í˜
    intelligence INTEGER DEFAULT 10,      -- ì§€ëŠ¥
    charisma INTEGER DEFAULT 10,          -- ë§¤ë ¥
    luck INTEGER DEFAULT 10,              -- ìš´

    -- ìŠ¤í‚¬
    trading_skill INTEGER DEFAULT 1,      -- ê±°ë˜ ìŠ¤í‚¬
    negotiation_skill INTEGER DEFAULT 1,  -- í˜‘ìƒ ìŠ¤í‚¬
    appraisal_skill INTEGER DEFAULT 1,    -- ê°ì • ìŠ¤í‚¬

    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

#### **merchants** - ìƒì¸ ì •ë³´
```sql
CREATE TABLE merchants (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,                   -- ìƒì¸ ì´ë¦„
    title TEXT,                           -- ìƒì¸ ì§í•¨
    merchant_type TEXT NOT NULL,          -- ìƒì¸ íƒ€ì…
    personality TEXT NOT NULL,            -- ì„±ê²© ìœ í˜•
    district TEXT NOT NULL,               -- ì„œìš¸ êµ¬ì—­
    lat REAL NOT NULL,                    -- ìœ„ë„
    lng REAL NOT NULL,                    -- ê²½ë„
    required_license INTEGER DEFAULT 0,   -- í•„ìš” ë¼ì´ì„¼ìŠ¤
    reputation_requirement INTEGER DEFAULT 0, -- í•„ìš” í‰íŒ
    price_modifier REAL DEFAULT 1.0,     -- ê°€ê²© ë°°ìˆ˜
    negotiation_difficulty INTEGER DEFAULT 3, -- í˜‘ìƒ ë‚œì´ë„
    image_filename TEXT,                  -- ì´ë¯¸ì§€ íŒŒì¼ëª…
    last_restocked DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_active BOOLEAN DEFAULT TRUE
);
```

#### **item_templates** - ì•„ì´í…œ í…œí”Œë¦¿
```sql
CREATE TABLE item_templates (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,                   -- ì•„ì´í…œ ì´ë¦„
    category TEXT NOT NULL,               -- ì¹´í…Œê³ ë¦¬
    grade INTEGER NOT NULL,               -- ë“±ê¸‰ (1-5)
    base_price INTEGER NOT NULL,          -- ê¸°ë³¸ ê°€ê²©
    weight REAL DEFAULT 1.0,              -- ë¬´ê²Œ
    description TEXT,                     -- ì„¤ëª…
    icon_id INTEGER DEFAULT 1,            -- ì•„ì´ì½˜ ID
    required_license INTEGER DEFAULT 0,   -- í•„ìš” ë¼ì´ì„¼ìŠ¤
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

#### **merchant_inventory** - ìƒì¸ ì¸ë²¤í† ë¦¬
```sql
CREATE TABLE merchant_inventory (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    merchant_id TEXT NOT NULL,
    item_template_id INTEGER NOT NULL,
    current_price INTEGER NOT NULL,       -- í˜„ì¬ íŒë§¤ ê°€ê²©
    quantity INTEGER NOT NULL,            -- ë³´ìœ  ìˆ˜ëŸ‰
    last_updated DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (merchant_id) REFERENCES merchants(id),
    FOREIGN KEY (item_template_id) REFERENCES item_templates(id)
);
```

#### **player_items** - í”Œë ˆì´ì–´ ì•„ì´í…œ
```sql
CREATE TABLE player_items (
    id TEXT PRIMARY KEY,
    player_id TEXT NOT NULL,
    item_template_id INTEGER NOT NULL,
    quantity INTEGER DEFAULT 1,
    storage_type TEXT DEFAULT 'inventory', -- 'inventory' or 'storage'
    acquired_price INTEGER,               -- ì·¨ë“ ê°€ê²©
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (player_id) REFERENCES players(id),
    FOREIGN KEY (item_template_id) REFERENCES item_templates(id)
);
```

### ğŸ”— ê´€ê³„ í…Œì´ë¸”ë“¤

#### **merchant_relationships** - ìƒì¸ê³¼ì˜ ê´€ê³„
```sql
CREATE TABLE merchant_relationships (
    player_id TEXT NOT NULL,
    merchant_id TEXT NOT NULL,
    friendship_points INTEGER DEFAULT 0,  -- ì¹œë°€ë„
    trust_level INTEGER DEFAULT 0,        -- ì‹ ë¢° ë ˆë²¨
    total_trades INTEGER DEFAULT 0,       -- ì´ ê±°ë˜ íšŸìˆ˜
    total_spent INTEGER DEFAULT 0,        -- ì´ ì§€ì¶œ ê¸ˆì•¡
    last_interaction DATETIME,            -- ë§ˆì§€ë§‰ ìƒí˜¸ì‘ìš©
    notes TEXT,                          -- ë©”ëª¨
    PRIMARY KEY (player_id, merchant_id)
);
```

#### **quest_templates** - í€˜ìŠ¤íŠ¸ í…œí”Œë¦¿
```sql
CREATE TABLE quest_templates (
    id TEXT PRIMARY KEY,
    title TEXT NOT NULL,                  -- í€˜ìŠ¤íŠ¸ ì œëª©
    description TEXT NOT NULL,            -- ì„¤ëª…
    category TEXT NOT NULL,               -- ì¹´í…Œê³ ë¦¬
    quest_type TEXT NOT NULL,             -- í€˜ìŠ¤íŠ¸ íƒ€ì…
    objectives TEXT,                      -- ëª©í‘œ (JSON)
    rewards TEXT,                         -- ë³´ìƒ (JSON)
    requirements TEXT,                    -- ìš”êµ¬ì‚¬í•­ (JSON)
    level_requirement INTEGER DEFAULT 1,  -- í•„ìš” ë ˆë²¨
    required_license INTEGER DEFAULT 0,   -- í•„ìš” ë¼ì´ì„¼ìŠ¤
    repeatable BOOLEAN DEFAULT FALSE,     -- ë°˜ë³µ ê°€ëŠ¥ ì—¬ë¶€
    cooldown_hours INTEGER DEFAULT 0,     -- ì¿¨ë‹¤ìš´ ì‹œê°„
    priority INTEGER DEFAULT 0,          -- ìš°ì„ ìˆœìœ„
    sort_order INTEGER DEFAULT 0,        -- ì •ë ¬ ìˆœì„œ
    is_active BOOLEAN DEFAULT TRUE
);
```

#### **player_quests** - í”Œë ˆì´ì–´ í€˜ìŠ¤íŠ¸ ì§„í–‰ìƒí™©
```sql
CREATE TABLE player_quests (
    id TEXT PRIMARY KEY,
    player_id TEXT NOT NULL,
    quest_template_id TEXT NOT NULL,
    status TEXT DEFAULT 'active',         -- 'active', 'completed', 'failed'
    progress TEXT,                        -- ì§„í–‰ìƒí™© (JSON)
    accepted_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    completed_at DATETIME,
    reward_claimed BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (player_id) REFERENCES players(id),
    FOREIGN KEY (quest_template_id) REFERENCES quest_templates(id)
);
```

---

## 5. API ì—”ë“œí¬ì¸íŠ¸

### ğŸ” ì¸ì¦ ì‹œìŠ¤í…œ

**JWT í† í° ê¸°ë°˜ ì¸ì¦**
- **ë¡œê·¸ì¸**: `POST /api/auth/login`
- **íšŒì›ê°€ì…**: `POST /api/auth/register`
- **í† í° ê°±ì‹ **: `POST /api/auth/refresh`

**ì¸ì¦ í—¤ë” í˜•ì‹:**
```
Authorization: Bearer <JWT_TOKEN>
```

### ğŸ‘¤ í”Œë ˆì´ì–´ API (`/api/player`)

#### **GET /api/player/profile**
í”Œë ˆì´ì–´ í”„ë¡œí•„ ë° ìƒì„¸ ì •ë³´ ì¡°íšŒ

**ì‘ë‹µ êµ¬ì¡°:**
```json
{
  "success": true,
  "data": {
    "id": "player_id",
    "name": "í”Œë ˆì´ì–´ëª…",
    "level": 5,
    "experience": 1250,
    "money": 75000,
    "trustPoints": 120,
    "reputation": 85,
    "currentLicense": 2,
    "maxInventorySize": 8,
    "maxStorageSize": 50,
    "statPoints": 3,
    "skillPoints": 1,
    "strength": 15,
    "intelligence": 12,
    "charisma": 18,
    "luck": 10,
    "tradingSkill": 45,
    "negotiationSkill": 38,
    "appraisalSkill": 22,
    "location": {
      "lat": 37.5665,
      "lng": 126.9780
    },
    "inventory": [...],
    "storageItems": [...],
    "recentTrades": [...]
  }
}
```

### ğŸª ìƒì¸ API (`/api/merchants`)

#### **GET /api/merchants/nearby**
ìœ„ì¹˜ ê¸°ë°˜ ê·¼ì²˜ ìƒì¸ ì¡°íšŒ

**ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°:**
- `lat`: ìœ„ë„ (í•„ìˆ˜)
- `lng`: ê²½ë„ (í•„ìˆ˜)
- `radius`: ê²€ìƒ‰ ë°˜ê²½ (ì„ íƒ, ê¸°ë³¸ê°’ 1000m)

**ì‘ë‹µ êµ¬ì¡°:**
```json
{
  "success": true,
  "data": {
    "merchants": [
      {
        "id": "seoye",
        "name": "ì„œì˜ˆë‚˜",
        "title": "ë„¤ì˜¤-ì‹œí‹° ìŠ¤íƒ€ì¼ë¦¬ìŠ¤íŠ¸",
        "type": "fashion",
        "personality": "cold",
        "district": "neo_shibuya",
        "location": {
          "lat": 37.5665,
          "lng": 126.9780
        },
        "distance": 250,
        "canTrade": true,
        "requiredLicense": 1,
        "reputationRequirement": 0,
        "priceModifier": 1.2,
        "negotiationDifficulty": 4,
        "inventoryCount": 12,
        "lastRestocked": "2024-01-15T08:00:00Z"
      }
    ],
    "total": 3,
    "searchParams": {
      "lat": 37.5665,
      "lng": 126.9780,
      "radius": 1000
    }
  }
}
```

#### **GET /api/merchants/:merchantId**
íŠ¹ì • ìƒì¸ì˜ ìƒì„¸ ì •ë³´ ë° ì¸ë²¤í† ë¦¬ ì¡°íšŒ

**ì‘ë‹µ êµ¬ì¡°:**
```json
{
  "success": true,
  "data": {
    "id": "seoye",
    "name": "ì„œì˜ˆë‚˜",
    "title": "ë„¤ì˜¤-ì‹œí‹° ìŠ¤íƒ€ì¼ë¦¬ìŠ¤íŠ¸",
    "type": "fashion",
    "personality": "cold",
    "district": "neo_shibuya",
    "location": {
      "lat": 37.5665,
      "lng": 126.9780
    },
    "requiredLicense": 1,
    "reputationRequirement": 0,
    "priceModifier": 1.2,
    "negotiationDifficulty": 4,
    "lastRestocked": "2024-01-15T08:00:00Z",
    "preferredCategories": ["fashion", "accessories"],
    "dislikedCategories": ["food"],
    "inventory": [
      {
        "id": "item_001",
        "itemTemplateId": 15,
        "name": "ëª…í’ˆ í•¸ë“œë°±",
        "category": "fashion",
        "grade": 4,
        "basePrice": 800000,
        "currentPrice": 960000,
        "quantity": 2,
        "weight": 0.8,
        "description": "ìµœê³ ê¸‰ ê°€ì£½ìœ¼ë¡œ ì œì‘ëœ ëª…í’ˆ í•¸ë“œë°±",
        "iconId": 45,
        "requiredLicense": 2,
        "lastUpdated": "2024-01-15T08:00:00Z"
      }
    ],
    "relationship": {
      "friendshipPoints": 150,
      "trustLevel": 3,
      "totalTrades": 8,
      "totalSpent": 1250000,
      "lastInteraction": "2024-01-14T15:30:00Z",
      "notes": null
    }
  }
}
```

### ğŸ“‹ í€˜ìŠ¤íŠ¸ API (`/api/quests`)

#### **GET /api/quests/available**
ìˆ˜í–‰ ê°€ëŠ¥í•œ í€˜ìŠ¤íŠ¸ ëª©ë¡ ì¡°íšŒ

**ì‘ë‹µ êµ¬ì¡°:**
```json
{
  "success": true,
  "data": {
    "quests": [
      {
        "id": "daily_trade_001",
        "title": "ì²« ë²ˆì§¸ ê±°ë˜",
        "description": "ìƒì¸ê³¼ ì²« ê±°ë˜ë¥¼ ì™„ë£Œí•˜ì„¸ìš”",
        "category": "tutorial",
        "questType": "trade",
        "maxProgress": 1,
        "currentProgress": 0,
        "rewards": {
          "money": 5000,
          "experience": 100,
          "items": []
        },
        "requirements": {
          "level": 1,
          "license": 0
        },
        "isRepeatable": false,
        "cooldownHours": 0,
        "priority": 1,
        "status": "available"
      }
    ],
    "total": 5
  }
}
```

#### **POST /api/quests/:questId/accept**
í€˜ìŠ¤íŠ¸ ìˆ˜ë½

#### **POST /api/quests/:questId/complete**
í€˜ìŠ¤íŠ¸ ì™„ë£Œ ë° ë³´ìƒ ìˆ˜ë ¹

### ğŸ’° ê±°ë˜ API (`/api/trade`)

#### **POST /api/trade/buy**
ì•„ì´í…œ êµ¬ë§¤

**ìš”ì²­ êµ¬ì¡°:**
```json
{
  "merchantId": "seoye",
  "itemId": "item_001",
  "quantity": 1,
  "offeredPrice": 950000
}
```

#### **POST /api/trade/sell**
ì•„ì´í…œ íŒë§¤

**ìš”ì²­ êµ¬ì¡°:**
```json
{
  "merchantId": "seoye",
  "playerItemId": "player_item_123",
  "quantity": 1,
  "askingPrice": 1000000
}
```

---

## 6. ê²Œì„ ì‹œìŠ¤í…œ ë¡œì§

### ğŸ’ ê±°ë˜ ì‹œìŠ¤í…œ

#### **ê°€ê²© ê³„ì‚° ë¡œì§**
```javascript
function calculateFinalPrice(basePrice, merchant, item, player) {
    let finalPrice = basePrice;

    // ìƒì¸ì˜ ê¸°ë³¸ ê°€ê²© ë°°ìˆ˜ ì ìš©
    finalPrice *= merchant.priceModifier;

    // ì„ í˜¸ ì¹´í…Œê³ ë¦¬ í• ì¸ (10%)
    if (merchant.preferredCategories.includes(item.category)) {
        finalPrice *= 0.9;
    }

    // ë¹„ì„ í˜¸ ì¹´í…Œê³ ë¦¬ í• ì¦ (20%)
    if (merchant.dislikedCategories.includes(item.category)) {
        finalPrice *= 1.2;
    }

    // í”Œë ˆì´ì–´ ê´€ê³„ë„ì— ë”°ë¥¸ í• ì¸
    const relationship = getRelationship(player.id, merchant.id);
    const discountRate = Math.min(relationship.trustLevel * 0.02, 0.15); // ìµœëŒ€ 15% í• ì¸
    finalPrice *= (1 - discountRate);

    return Math.round(finalPrice);
}
```

#### **ê±°ë˜ ì„±ê³µ ì¡°ê±´**
1. **ë¼ì´ì„¼ìŠ¤ ê²€ì¦**: `player.currentLicense >= item.requiredLicense`
2. **ìê¸ˆ í™•ì¸**: `player.money >= finalPrice` (êµ¬ë§¤ ì‹œ)
3. **ì¸ë²¤í† ë¦¬ ê³µê°„**: `inventory.length < player.maxInventorySize`
4. **ìƒì¸ ì¬ê³ **: `merchantItem.quantity >= requestedQuantity`

#### **ê´€ê³„ë„ ì‹œìŠ¤í…œ**
```javascript
function updateMerchantRelationship(playerId, merchantId, tradeAmount) {
    const friendshipGain = Math.floor(tradeAmount / 10000); // 10,000ì›ë‹¹ 1 í¬ì¸íŠ¸
    const trustGain = tradeAmount > 100000 ? 1 : 0; // 10ë§Œì› ì´ìƒ ê±°ë˜ì‹œ ì‹ ë¢°ë„ +1

    updateRelationship(playerId, merchantId, {
        friendship_points: friendshipGain,
        trust_level: trustGain,
        total_trades: 1,
        total_spent: tradeAmount,
        last_interaction: new Date()
    });
}
```

### ğŸ¯ í€˜ìŠ¤íŠ¸ ì‹œìŠ¤í…œ

#### **í€˜ìŠ¤íŠ¸ íƒ€ì…ë³„ ì²˜ë¦¬**
- **trade**: ê±°ë˜ íšŸìˆ˜/ê¸ˆì•¡ ë‹¬ì„±
- **collect**: íŠ¹ì • ì•„ì´í…œ ìˆ˜ì§‘
- **visit**: íŠ¹ì • ìƒì¸ ë°©ë¬¸
- **social**: í”Œë ˆì´ì–´ ê°„ ìƒí˜¸ì‘ìš©
- **achievement**: íŠ¹ì • ì„±ì·¨ ë‹¬ì„±

#### **ì§„í–‰ìƒí™© ì—…ë°ì´íŠ¸**
```javascript
async function updateQuestProgress(playerId, action, data) {
    const activeQuests = await getActiveQuests(playerId);

    for (const quest of activeQuests) {
        if (quest.questType === action) {
            const progress = JSON.parse(quest.progress);

            switch (action) {
                case 'trade':
                    progress.tradeCount = (progress.tradeCount || 0) + 1;
                    progress.tradeAmount = (progress.tradeAmount || 0) + data.amount;
                    break;
                case 'collect':
                    progress.itemsCollected = progress.itemsCollected || {};
                    progress.itemsCollected[data.itemId] =
                        (progress.itemsCollected[data.itemId] || 0) + data.quantity;
                    break;
            }

            await updateQuestProgress(quest.id, progress);

            // ì™„ë£Œ ì¡°ê±´ í™•ì¸
            if (isQuestCompleted(quest, progress)) {
                await completeQuest(quest.id);
            }
        }
    }
}
```

### ğŸ—ºï¸ ìœ„ì¹˜ ê¸°ë°˜ ì„œë¹„ìŠ¤

#### **ê±°ë¦¬ ê³„ì‚° (í•˜ë²„ì‚¬ì¸ ê³µì‹)**
```javascript
function calculateDistance(lat1, lng1, lat2, lng2) {
    const R = 6371e3; // ì§€êµ¬ ë°˜ì§€ë¦„ (ë¯¸í„°)
    const Ï†1 = lat1 * Math.PI/180;
    const Ï†2 = lat2 * Math.PI/180;
    const Î”Ï† = (lat2-lat1) * Math.PI/180;
    const Î”Î» = (lng2-lng1) * Math.PI/180;

    const a = Math.sin(Î”Ï†/2) * Math.sin(Î”Ï†/2) +
              Math.cos(Ï†1) * Math.cos(Ï†2) *
              Math.sin(Î”Î»/2) * Math.sin(Î”Î»/2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

    return R * c; // ë¯¸í„° ë‹¨ìœ„
}
```

#### **ê·¼ì²˜ ìƒì¸ í•„í„°ë§**
- ê¸°ë³¸ ë°˜ê²½: 1,000m
- ìµœëŒ€ ë°˜ê²½: 5,000m
- ê±°ë¦¬ìˆœ ì •ë ¬
- ê±°ë˜ ê°€ëŠ¥ ì—¬ë¶€ í‘œì‹œ

---

## 7. ìƒì¸ ìºë¦­í„° ì •ë³´

### ğŸ‘¥ 8ëª…ì˜ ê°œì„± ìˆëŠ” ìƒì¸ë“¤

#### **1. ì„œì˜ˆë‚˜ (Seoyena) - ë„¤ì˜¤-ì‹œí‹° ìŠ¤íƒ€ì¼ë¦¬ìŠ¤íŠ¸**
```json
{
  "id": "seoye",
  "name": "ì„œì˜ˆë‚˜",
  "title": "ë„¤ì˜¤-ì‹œí‹° ìŠ¤íƒ€ì¼ë¦¬ìŠ¤íŠ¸",
  "type": "fashion",
  "personality": "cold",
  "district": "neo_shibuya",
  "location": { "lat": 37.5665, "lng": 126.9780 },
  "specialties": ["íŒ¨ì…˜", "ì•¡ì„¸ì„œë¦¬", "ëª…í’ˆ"],
  "priceModifier": 1.2,
  "negotiationDifficulty": 4,
  "preferredCategories": ["fashion", "accessories", "luxury"],
  "dislikedCategories": ["food", "basic_items"],
  "personality_traits": {
    "greeting": "ì°¨ê°‘ì§€ë§Œ ì „ë¬¸ì ",
    "haggling": "ê¹Œë‹¤ë¡­ê³  ìì¡´ì‹¬ ê°•í•¨",
    "relationship_building": "ì‹¤ë ¥ ì¸ì •ë°›ì•„ì•¼ ì¹œí•´ì§"
  }
}
```

#### **2. ë§ˆë¦¬ (Mari) - ë”°ëœ»í•œ ë™ë„¤ ìƒì  ì‚¬ì¥**
```json
{
  "id": "mariapple",
  "name": "ë§ˆë¦¬",
  "title": "ì •ë‹¤ìš´ ë™ë„¤ ìƒì  ì‚¬ì¥",
  "type": "retail",
  "personality": "warm",
  "district": "jung",
  "location": { "lat": 37.5636, "lng": 126.9979 },
  "specialties": ["ì¼ìš©í’ˆ", "ì‹í’ˆ", "ìƒí•„í’ˆ"],
  "priceModifier": 0.95,
  "negotiationDifficulty": 2,
  "preferredCategories": ["food", "daily_items", "basic"],
  "dislikedCategories": ["luxury", "electronics"],
  "personality_traits": {
    "greeting": "ë”°ëœ»í•˜ê³  ì¹œê·¼í•¨",
    "haggling": "í•©ë¦¬ì ì´ê³  ìœ ì—°í•¨",
    "relationship_building": "ì‰½ê²Œ ì¹œí•´ì§€ê³  ì •ì´ ë§ìŒ"
  }
}
```

#### **3. ê¹€ì„¸íœ˜ (Kimsehwui) - ë² í…Œë‘ íŠ¸ë ˆì´ë”**
```json
{
  "id": "Seongbok",
  "name": "ê¹€ì„¸íœ˜",
  "title": "ë² í…Œë‘ íŠ¸ë ˆì´ë”",
  "type": "wholesale",
  "personality": "professional",
  "district": "jung",
  "location": { "lat": 37.5636, "lng": 126.9979 },
  "specialties": ["ì „ìì œí’ˆ", "ëŒ€ëŸ‰ê±°ë˜", "ë„ë§¤"],
  "priceModifier": 1.1,
  "negotiationDifficulty": 3,
  "preferredCategories": ["electronics", "wholesale", "rare"],
  "dislikedCategories": ["food", "basic_items"],
  "personality_traits": {
    "greeting": "ë¹„ì¦ˆë‹ˆìŠ¤ë¼ì´í¬í•˜ê³  ì „ë¬¸ì ",
    "haggling": "ë…¼ë¦¬ì ì´ê³  ê³„ì‚°ì ",
    "relationship_building": "ì‹¤ë ¥ê³¼ ì‹ ë¢°ë„ ì¤‘ì‹œ"
  }
}
```

#### **4. ì• ë‹ˆë°• (Alicegang) - ì•„í‹°ìŠ¤íŠ¸ ìƒì¸**
```json
{
  "id": "Alicegang",
  "name": "ì• ë‹ˆë°•",
  "title": "ì•„í‹°ìŠ¤íŠ¸ ìƒì¸",
  "type": "artist",
  "personality": "creative",
  "district": "jung",
  "location": { "lat": 37.5636, "lng": 126.9979 },
  "specialties": ["ì˜ˆìˆ í’ˆ", "ìˆ˜ì§‘í’ˆ", "ë…íŠ¹í•œ ì•„ì´í…œ"],
  "priceModifier": 1.3,
  "negotiationDifficulty": 3,
  "preferredCategories": ["art", "collectibles", "unique"],
  "dislikedCategories": ["mass_produced", "basic_items"],
  "personality_traits": {
    "greeting": "ë…íŠ¹í•˜ê³  ì°½ì˜ì ",
    "haggling": "ê°ì„±ì ì´ê³  ì§ê´€ì ",
    "relationship_building": "ì˜ˆìˆ ì  ì•ˆëª© ì¤‘ì‹œ"
  }
}
```

#### **5. ì¹´íƒ€ë¦¬ë‚˜ ìµœ (Catarina Choi) - ê¸€ë¡œë²Œ ë°”ì´ì–´**
```json
{
  "id": "nacho",
  "name": "ì¹´íƒ€ë¦¬ë‚˜ ìµœ",
  "title": "ê¸€ë¡œë²Œ ë°”ì´ì–´",
  "type": "luxury",
  "personality": "sophisticated",
  "district": "jung",
  "location": { "lat": 37.5636, "lng": 126.9979 },
  "specialties": ["ëª…í’ˆ", "ìˆ˜ì…í’ˆ", "ê³ ê¸‰ ì•„ì´í…œ"],
  "priceModifier": 1.4,
  "negotiationDifficulty": 4,
  "preferredCategories": ["luxury", "imported", "premium"],
  "dislikedCategories": ["cheap", "local_basic"],
  "personality_traits": {
    "greeting": "ì„¸ë ¨ë˜ê³  êµ­ì œì ",
    "haggling": "ê³ ê¸‰ìŠ¤ëŸ½ê³  í’ˆìœ„ ìˆìŒ",
    "relationship_building": "ì„¸ë ¨ëœ ì·¨í–¥ ì¤‘ì‹œ"
  }
}
```

#### **6. ì§„ë°±í˜¸ (Jinbaekho) - ì¹´í˜ ì‚¬ì¥ ê²¸ ì •ë³´ìƒ**
```json
{
  "id": "corea",
  "name": "ì§„ë°±í˜¸",
  "title": "ì¹´í˜ ì‚¬ì¥ ê²¸ ì •ë³´ìƒ",
  "type": "cafe",
  "personality": "friendly",
  "district": "gangdong",
  "location": { "lat": 37.5301, "lng": 127.1238 },
  "specialties": ["ì •ë³´", "ì†Œì‹", "ì»¤ë®¤ë‹ˆí‹°"],
  "priceModifier": 1.0,
  "negotiationDifficulty": 2,
  "preferredCategories": ["information", "community", "food"],
  "dislikedCategories": ["illegal", "suspicious"],
  "personality_traits": {
    "greeting": "ì¹œê·¼í•˜ê³  ì‚¬êµì ",
    "haggling": "í•©ë¦¬ì ì´ê³  ìƒí™© íŒŒì•… ë¹ ë¦„",
    "relationship_building": "ì •ë³´ êµí™˜ ì¤‘ì‹œ"
  }
}
```

#### **7. ì£¼ë¶ˆìˆ˜ (Jubulsu) - ë¬´ê¸°ìƒ**
```json
{
  "id": "joo",
  "name": "ì£¼ë¶ˆìˆ˜",
  "title": "ë¬´ê¸°ìƒ",
  "type": "weaponsmith",
  "personality": "tough",
  "district": "gangdong",
  "location": { "lat": 37.5301, "lng": 127.1238 },
  "specialties": ["ë¬´ê¸°", "ë°©ì–´êµ¬", "ì „íˆ¬ ì•„ì´í…œ"],
  "priceModifier": 1.15,
  "negotiationDifficulty": 3,
  "preferredCategories": ["weapons", "armor", "combat"],
  "dislikedCategories": ["fashion", "food"],
  "personality_traits": {
    "greeting": "ê±°ì¹ ì§€ë§Œ ì†”ì§í•¨",
    "haggling": "ì§ì„¤ì ì´ê³  ë‹¨ë„ì§ì…ì ",
    "relationship_building": "ì‹¤ë ¥ê³¼ ë‹´ë ¥ ì¤‘ì‹œ"
  }
}
```

#### **8. ê¸°ì£¼ë¦¬ (Kijuri) - ì‹œê°„ ê²½ë¹„ì›**
```json
{
  "id": "Kijuri",
  "name": "ê¸°ì£¼ë¦¬",
  "title": "ì‹œê°„ ê²½ë¹„ì›",
  "type": "mystic",
  "personality": "mysterious",
  "district": "special",
  "location": { "lat": 37.5172, "lng": 127.0473 },
  "specialties": ["í¬ê·€ ì•„ì´í…œ", "ì‹ ë¹„ë¡œìš´ ë¬¼ê±´", "ì‹œê°„ ê´€ë ¨"],
  "priceModifier": 1.5,
  "negotiationDifficulty": 5,
  "preferredCategories": ["rare", "mystic", "time_related"],
  "dislikedCategories": ["common", "mass_produced"],
  "personality_traits": {
    "greeting": "ì‹ ë¹„ë¡­ê³  ìˆ˜ìˆ˜ê»˜ë¼ ê°™ìŒ",
    "haggling": "ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•˜ê³  ë…íŠ¹í•¨",
    "relationship_building": "ì‹œê°„ê³¼ ìš´ëª… ì¤‘ì‹œ"
  }
}
```

### ğŸ­ ìƒì¸ë³„ ê±°ë˜ íŠ¹ì„±

#### **ê°€ê²© ì •ì±…**
- **ë§ˆë¦¬**: ê°€ì¥ ì €ë ´ (5% í• ì¸)
- **ì§„ë°±í˜¸**: í‘œì¤€ ê°€ê²©
- **ê¹€ì„¸íœ˜, ì£¼ë¶ˆìˆ˜**: ì•½ê°„ ë¹„ìŒˆ (+10-15%)
- **ì„œì˜ˆë‚˜, ì¹´íƒ€ë¦¬ë‚˜**: ë¹„ìŒˆ (+20-40%)
- **ê¸°ì£¼ë¦¬**: ê°€ì¥ ë¹„ìŒˆ (+50%)

#### **í˜‘ìƒ ë‚œì´ë„**
1. **ì‰¬ì›€**: ë§ˆë¦¬, ì§„ë°±í˜¸
2. **ë³´í†µ**: ê¹€ì„¸íœ˜, ì• ë‹ˆë°•, ì£¼ë¶ˆìˆ˜
3. **ì–´ë ¤ì›€**: ì„œì˜ˆë‚˜, ì¹´íƒ€ë¦¬ë‚˜
4. **ë§¤ìš° ì–´ë ¤ì›€**: ê¸°ì£¼ë¦¬

---

## 8. ì‹¤ì‹œê°„ í†µì‹ 

### ğŸ”Œ Socket.IO ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ

#### **ì—°ê²° ê´€ë¦¬**
```javascript
// í´ë¼ì´ì–¸íŠ¸ ì—°ê²°
io.on('connection', (socket) => {
    console.log('í”Œë ˆì´ì–´ ì—°ê²°:', socket.id);

    // í”Œë ˆì´ì–´ ì •ë³´ ë“±ë¡
    socket.on('player:register', (playerData) => {
        socket.playerId = playerData.playerId;
        socket.playerName = playerData.playerName;
        socket.join(`player:${playerData.playerId}`);
    });
});
```

#### **ìœ„ì¹˜ ì—…ë°ì´íŠ¸**
```javascript
// í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„
socket.emit('location:update', {
    lat: 37.5665,
    lng: 126.9780,
    timestamp: Date.now()
});

// ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸
socket.on('location:update', (locationData) => {
    // ê·¼ì²˜ ìƒì¸ ê²€ìƒ‰
    const nearbyMerchants = findNearbyMerchants(locationData);

    // í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ê·¼ì²˜ ìƒì¸ ì •ë³´ ì „ì†¡
    socket.emit('merchants:nearby', nearbyMerchants);
});
```

#### **ì‹¤ì‹œê°„ ê±°ë˜**
```javascript
// ê±°ë˜ ìš”ì²­
socket.emit('trade:request', {
    merchantId: 'seoye',
    itemId: 'item_001',
    type: 'buy',
    offeredPrice: 950000
});

// ê±°ë˜ ì‘ë‹µ
socket.on('trade:response', (response) => {
    if (response.success) {
        // ê±°ë˜ ì„±ê³µ - UI ì—…ë°ì´íŠ¸
        updateInventory(response.data.updatedInventory);
        updateMoney(response.data.updatedMoney);
    } else {
        // ê±°ë˜ ì‹¤íŒ¨ - ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
        showError(response.error);
    }
});
```

#### **ì±„íŒ… ì‹œìŠ¤í…œ**
```javascript
// ë©”ì‹œì§€ ì „ì†¡
socket.emit('chat:message', {
    recipientId: 'player_123',
    message: 'ì•ˆë…•í•˜ì„¸ìš”!',
    timestamp: Date.now()
});

// ë©”ì‹œì§€ ìˆ˜ì‹ 
socket.on('chat:message', (messageData) => {
    displayMessage(messageData);
});
```

### ğŸ“¡ ì£¼ìš” Socket ì´ë²¤íŠ¸ ëª©ë¡

| ì´ë²¤íŠ¸ëª… | ë°©í–¥ | ì„¤ëª… |
|---------|------|------|
| `player:register` | Câ†’S | í”Œë ˆì´ì–´ ë“±ë¡ |
| `location:update` | Câ†’S | ìœ„ì¹˜ ì—…ë°ì´íŠ¸ |
| `merchants:nearby` | Sâ†’C | ê·¼ì²˜ ìƒì¸ ì •ë³´ |
| `trade:request` | Câ†’S | ê±°ë˜ ìš”ì²­ |
| `trade:response` | Sâ†’C | ê±°ë˜ ì‘ë‹µ |
| `trade:notification` | Sâ†’C | ê±°ë˜ ì•Œë¦¼ |
| `chat:message` | Câ†”S | ì±„íŒ… ë©”ì‹œì§€ |
| `chat:typing` | Câ†”S | íƒ€ì´í•‘ ìƒíƒœ |
| `quest:update` | Sâ†’C | í€˜ìŠ¤íŠ¸ ì§„í–‰ ì—…ë°ì´íŠ¸ |
| `player:stats_update` | Sâ†’C | í”Œë ˆì´ì–´ ìŠ¤íƒ¯ ë³€ê²½ |

---

## 9. ë°°í¬ ë° í™˜ê²½

### ğŸš€ Railway ë°°í¬ ì„¤ì •

#### **í™˜ê²½ ë³€ìˆ˜**
```bash
# ë°ì´í„°ë² ì´ìŠ¤
DB_PATH=./data/way_game.sqlite

# JWT ì„¤ì •
JWT_SECRET=your_jwt_secret_key
JWT_REFRESH_SECRET=your_refresh_secret_key

# ì„œë²„ ì„¤ì •
PORT=3000
NODE_ENV=production

# CORS ì„¤ì •
ALLOWED_ORIGINS=https://your-app-domain.com,http://localhost:3000

# ì‹œë“œ ë°ì´í„° ì‹¤í–‰ ì—¬ë¶€
RUN_SEED=true

# ë¡œê·¸ ë ˆë²¨
LOG_LEVEL=info
```

#### **Railway ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸**
```json
{
  "scripts": {
    "build": "npm install",
    "start": "node src/server.js",
    "migrate": "node src/database/migrate.js",
    "seed": "node src/database/seed.js"
  }
}
```

#### **ë°°í¬ í”„ë¡œì„¸ìŠ¤**
1. **ì½”ë“œ í‘¸ì‹œ**: Git push to main branch
2. **ìë™ ë¹Œë“œ**: Railway auto-build trigger
3. **ì˜ì¡´ì„± ì„¤ì¹˜**: `npm install`
4. **ë§ˆì´ê·¸ë ˆì´ì…˜**: `npm run migrate`
5. **ì‹œë“œ ë°ì´í„°**: `npm run seed` (RUN_SEED=trueì¼ ë•Œ)
6. **ì„œë²„ ì‹œì‘**: `npm start`

### ğŸŒ ì„œë²„ URL ë° ì—”ë“œí¬ì¸íŠ¸

#### **í”„ë¡œë•ì…˜ URL**
- **Base URL**: `https://way3-production.up.railway.app`
- **API Base**: `https://way3-production.up.railway.app/api`
- **Socket URL**: `https://way3-production.up.railway.app`

#### **ê°œë°œ í™˜ê²½**
- **Local URL**: `http://localhost:3000`
- **API Base**: `http://localhost:3000/api`
- **Socket URL**: `http://localhost:3000`

### ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

#### **ë¡œê¹… ì‹œìŠ¤í…œ (Winston)**
```javascript
const winston = require('winston');

const logger = winston.createLogger({
    level: process.env.LOG_LEVEL || 'info',
    format: winston.format.combine(
        winston.format.timestamp(),
        winston.format.errors({ stack: true }),
        winston.format.colorize(),
        winston.format.simple()
    ),
    transports: [
        new winston.transports.Console(),
        new winston.transports.File({
            filename: 'logs/error.log',
            level: 'error'
        }),
        new winston.transports.File({
            filename: 'logs/combined.log'
        })
    ]
});
```

#### **ë©”íŠ¸ë¦­ ìˆ˜ì§‘**
- **ì—°ê²°ëœ í”Œë ˆì´ì–´ ìˆ˜**
- **ê±°ë˜ í†µê³„**
- **í€˜ìŠ¤íŠ¸ ì™„ë£Œìœ¨**
- **ì„œë²„ ì‘ë‹µ ì‹œê°„**
- **ì—ëŸ¬ ë°œìƒë¥ **

### ğŸ”§ ê°œë°œ ë„êµ¬

#### **ë¡œì»¬ ê°œë°œ í™˜ê²½ ì„¤ì •**
```bash
# í”„ë¡œì íŠ¸ í´ë¡ 
git clone <repository_url>
cd theway_server

# ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env

# ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
npm run migrate

# ì‹œë“œ ë°ì´í„° ìƒì„±
npm run seed

# ê°œë°œ ì„œë²„ ì‹œì‘
npm run dev
```

#### **ìœ ìš©í•œ ìŠ¤í¬ë¦½íŠ¸**
```bash
# ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
npm run migrate && npm run seed

# í”„ë¡œë•ì…˜ ë¹Œë“œ
npm run build

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm test

# ë¡œê·¸ í™•ì¸
tail -f logs/combined.log
```

---

## ğŸ“š ì¶”ê°€ ì°¸ê³  ìë£Œ

### ğŸ”— ê´€ë ¨ ë¬¸ì„œ
- [í´ë¼ì´ì–¸íŠ¸ SwiftUI êµ¬ì¡°](./Way3_Frontend_Design.md)
- [ê´€ë¦¬ì ì‹œìŠ¤í…œ](./Admin_System_Design.md)
- [API ìƒì„¸ ëª…ì„¸](./Admin_API_Specifications.md)

### ğŸ’¡ ê°œë°œ íŒ
1. **ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ ì‹œ**: í•­ìƒ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±
2. **ìƒˆë¡œìš´ API ì¶”ê°€ ì‹œ**: ì¸ì¦, ê²€ì¦, ì—ëŸ¬ ì²˜ë¦¬ í•„ìˆ˜ êµ¬í˜„
3. **Socket ì´ë²¤íŠ¸ ì¶”ê°€ ì‹œ**: í´ë¼ì´ì–¸íŠ¸ì™€ ë™ê¸°í™” í™•ì¸
4. **ë°°í¬ ì „**: ë¡œì»¬ì—ì„œ ì¶©ë¶„í•œ í…ŒìŠ¤íŠ¸ ì§„í–‰

### âš ï¸ ì£¼ì˜ì‚¬í•­
- **JWT ì‹œí¬ë¦¿**: í”„ë¡œë•ì…˜ì—ì„œëŠ” ë°˜ë“œì‹œ ê°•ë ¥í•œ í‚¤ ì‚¬ìš©
- **ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…**: ì •ê¸°ì ì¸ SQLite íŒŒì¼ ë°±ì—… ê¶Œì¥
- **ì—ëŸ¬ ì²˜ë¦¬**: ëª¨ë“  APIì—ì„œ ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€ ë°˜í™˜
- **ë¡œê·¸ ê´€ë¦¬**: ë¯¼ê°í•œ ì •ë³´ ë¡œê¹… ê¸ˆì§€

---

## ğŸ¯ ê²°ë¡ 

ì´ ë¬¸ì„œëŠ” Way3 Trading Gameì˜ ì„œë²„ ì•„í‚¤í…ì²˜ì™€ ë°ì´í„° êµ¬ì¡°ì— ëŒ€í•œ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.

**ì´ ë¬¸ì„œë¥¼ í†µí•´ í´ë¼ìš°ë“œëŠ” ë‹¤ìŒì„ ì™„ë²½í•˜ê²Œ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:**

âœ… **í”„ë¡œì íŠ¸ì˜ ì „ì²´ì ì¸ êµ¬ì¡°ì™€ ëª©í‘œ**
âœ… **8ëª…ì˜ ìºë¦­í„° ìƒì¸ ì‹œìŠ¤í…œê³¼ ê°ìì˜ íŠ¹ì„±**
âœ… **ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆì™€ í…Œì´ë¸” ê´€ê³„**
âœ… **API ì—”ë“œí¬ì¸íŠ¸ì™€ ìš”ì²­/ì‘ë‹µ êµ¬ì¡°**
âœ… **ì‹¤ì‹œê°„ Socket.IO í†µì‹  ë°©ì‹**
âœ… **ê±°ë˜, í€˜ìŠ¤íŠ¸, ìœ„ì¹˜ ê¸°ë°˜ ê²Œì„ ë¡œì§**
âœ… **Railway ë°°í¬ í™˜ê²½ê³¼ ì„¤ì •**

ì•ìœ¼ë¡œ ê°œë°œ ì‘ì—… ì‹œ ì´ ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ì—¬ ë”ìš± ì •í™•í•˜ê³  íš¨ìœ¨ì ì¸ ì§€ì›ì„ ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2024ë…„ 1ì›” 16ì¼
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2024ë…„ 1ì›” 16ì¼
**ë²„ì „**: 1.0.0